@tailwind base;
@tailwind components;
@tailwind utilities;

:root {
  color-scheme: dark;
  --bg: #050608;
  --fg: #ffffff;
  --muted: #c7cfdd;
  --muted-2: #98a2b3;
  --border: #1a2333;
  --panel: #0b111a;
  --accent-blue: #4da3ff;
  --accent-sea: #4dd4c6;
  --space-unit: 6px;
}

* {
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
}

body {
  @apply bg-ink-950 text-white;
  background: var(--bg);
  color: var(--fg);
}

a {
  @apply text-accent-blue transition-colors;
}

a:hover {
  @apply text-accent-sea;
}

::selection {
  background: rgba(77, 163, 255, 0.25);
}

.container-narrow {
  @apply mx-auto w-full max-w-4xl px-[18px];
}

.container-post {
  @apply mx-auto w-full max-w-3xl px-[18px];
}

.section {
  @apply py-12;
}

.section-tight {
  @apply py-8;
}

.heading-serif {
  @apply font-serif tracking-tight;
}

.prose-deadwater {
  @apply prose prose-invert max-w-none;
  --tw-prose-body: var(--muted);
  --tw-prose-headings: var(--fg);
  --tw-prose-links: var(--accent-blue);
  --tw-prose-bold: var(--fg);
  --tw-prose-quotes: #d2dbea;
  --tw-prose-code: #d2dbea;
  --tw-prose-pre-code: #e9eef6;
  --tw-prose-pre-bg: #0f1420;
  --tw-prose-hr: var(--border);
  --tw-prose-th-borders: var(--border);
  --tw-prose-td-borders: var(--border);
}

.prose-deadwater-post h1:first-of-type {
  display: none;
}

.tangent-layout {
  display: grid;
  gap: 24px;
}

.tangent-content {
  min-width: 0;
}

.tangent-link {
  display: inline-block;
  position: relative;
  border: 1px solid var(--accent-blue);
  padding: 0 6px;
  padding-right: 20px;
  border-radius: 999px;
  font-size: 0.92em;
  line-height: 1.6;
  white-space: normal;
  color: #e6f1ff;
  background: rgba(77, 163, 255, 0.15);
  box-decoration-break: clone;
  -webkit-box-decoration-break: clone;
  transition: border-color 0.2s ease, color 0.2s ease, background 0.2s ease;
}

.tangent-link::after {
  content: "+";
  position: absolute;
  right: 6px;
  width: 10px;
  text-align: center;
  font-size: 0.85em;
  opacity: 0.7;
}

.tangent-link.is-active::after {
  content: "-";
}

.tangent-link:hover {
  border-color: var(--accent-sea);
  color: #ffffff;
  background: rgba(77, 212, 198, 0.2);
}

.tangent-inline-group {
  position: relative;
}

.tangent-inline {
  display: none;
  margin-top: 8px;
  padding: 10px 12px;
  border: 1px solid var(--border);
  background: rgba(11, 17, 26, 0.7);
  color: var(--muted);
  font-size: 0.95em;
  line-height: 1.6;
  overflow-wrap: anywhere;
  white-space: pre-line;
}

.tangent-inline.is-active {
  display: block;
}

.tangent-panel {
  border: 1px solid var(--border);
  background: rgba(11, 17, 26, 0.75);
  padding: 16px;
}

.tangent-panel.is-active {
  border-color: rgba(77, 163, 255, 0.5);
}

.tangent-panel-inner {
  display: grid;
  gap: 12px;
}

.tangent-panel-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  text-transform: uppercase;
  letter-spacing: 0.3em;
  font-size: 0.65rem;
  color: var(--muted-2);
  min-height: 26px;
}

.tangent-panel-header .tangent-close {
  flex-shrink: 0;
  margin-top: -2px;
}

.tangent-panel-title {
  color: #b5c2d6;
}

.tangent-close {
  position: relative;
  border: 1px solid var(--border);
  width: 26px;
  height: 26px;
  border-radius: 999px;
  font-size: 0;
  line-height: 0;
  font-family: inherit;
  letter-spacing: normal;
  text-transform: none;
  color: var(--muted);
  display: inline-flex;
  align-items: center;
  justify-content: center;
  transition: border-color 0.2s ease, color 0.2s ease;
}

.tangent-close::before {
  content: "Ã—";
  position: absolute;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 16px;
  line-height: 1;
  letter-spacing: normal;
}

.tangent-close:hover {
  border-color: var(--accent-blue);
  color: #ffffff;
}

.tangent-panel-placeholder {
  font-size: 0.9rem;
  color: var(--muted-2);
}

.tangent-panel-label {
  font-size: 0.75rem;
  text-transform: uppercase;
  letter-spacing: 0.25em;
  color: var(--muted-2);
  margin-bottom: 6px;
}

.tangent-panel-body {
  display: grid;
  gap: 16px;
}

.tangent-panel-item {
  border-top: 1px solid var(--border);
  padding-top: 12px;
}

.tangent-panel-item:first-child {
  border-top: none;
  padding-top: 0;
}

.tangent-panel-item-head {
  display: flex;
  align-items: flex-start;
  justify-content: space-between;
  gap: 12px;
  margin-bottom: 6px;
}

.tangent-panel-label {
  flex: 1;
}

.tangent-panel-item-head .tangent-close {
  flex-shrink: 0;
  margin-top: -2px;
}

.tangent-panel-text {
  color: var(--muted);
  line-height: 1.7;
  overflow-wrap: anywhere;
  white-space: pre-line;
}

@media (min-width: 1024px) {
  .tangent-layout {
    grid-template-columns: minmax(0, 1fr) 0;
    align-items: start;
  }

  .tangent-panel {
    position: sticky;
    top: 120px;
    width: 300px;
    max-height: calc(100vh - 160px);
    overflow: auto;
    grid-column: 2;
    justify-self: end;
    transform: translateX(320px);
  }

  .tangent-inline {
    display: none !important;
  }
}

.prose-deadwater pre {
  @apply rounded-lg border border-ink-700;
}

.prose-deadwater code {
  @apply rounded bg-ink-800 px-1 py-0.5;
}

.prose-deadwater pre code {
  @apply bg-transparent p-0;
}

.prose-deadwater img {
  @apply my-8 h-auto w-full rounded-xl border border-ink-800;
}

.prose-deadwater figure {
  @apply my-10;
}

.prose-deadwater figcaption {
  @apply mt-3 text-sm text-slate-400;
}

.focus-ring {
  @apply focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-accent-blue focus-visible:ring-offset-2 focus-visible:ring-offset-ink-950;
}

.tag {
  @apply inline-flex items-center border border-ink-700 px-3 py-1 text-[11px] uppercase tracking-[0.25em] text-slate-300;
}

.divider {
  @apply my-10 h-px w-full bg-ink-800;
}

.card {
  @apply border border-ink-800 bg-ink-900/70 p-6;
}

.muted {
  @apply text-slate-300;
}

.highlight {
  @apply text-accent-blue;
}

.hljs {
  color: #e6edf7;
}

.hljs-comment,
.hljs-quote {
  color: #8a93a6;
}

.hljs-keyword,
.hljs-selector-tag,
.hljs-subst {
  color: #4da3ff;
}

.hljs-string,
.hljs-title,
.hljs-name,
.hljs-type,
.hljs-attribute,
.hljs-symbol,
.hljs-bullet,
.hljs-addition,
.hljs-variable,
.hljs-template-tag,
.hljs-template-variable {
  color: #4dd4c6;
}

.hljs-number,
.hljs-literal {
  color: #f7b955;
}

.hljs-deletion {
  color: #ff7b7b;
}

.eyebrow {
  @apply text-xs uppercase tracking-[0.4em] text-slate-400;
}

.rule {
  @apply h-px w-full bg-ink-800;
}

.grid-structure {
  @apply grid gap-10 md:grid-cols-[minmax(0,1fr)_220px];
}

.side-note {
  @apply text-xs uppercase tracking-[0.3em] text-slate-500;
}
